machine:
  python:
    version: 2.7.10

dependencies:
  pre:
    - sudo apt-get -y update
    - sudo apt-get install -f --yes libgdal-dev
    - pip install setuptools
    - pip install -U pip
    - pip install wheel
    - pip install cython>=0.21
    - pip install numpy==1.10.4
    - pip install -r requirements-dev.txt
    - pip install -e .

test:
  override:
    - python setup.py test


deployment:
  production:
    branch: master
    commands:
      - echo "[pypi]" > ~/.pypirc
      - echo "username:" $PYPI_USERNAME >> ~/.pypirc
      - echo "password:" $PYPI_PASSWORD >> ~/.pypirc
      - make release
